!function(a){var b=function(a,b){this.init(a,b)},c=null;b.prototype={init:function(b,c){this.$table=a(b),this.$thead=this.$table.find("thead"),this.$tbody=this.$table.find("tbody"),this.$tfoot=this.$table.find("tfoot");var d=this;this.$table.stupidtable({date:function(a,b){var c=new Date(a.replace(/-/g,"/")),d=new Date(b.replace(/-/g,"/"));return c-d},moveBlanks:function(a,b){return b>a?""==a?1:-1:a>b?""==b?-1:1:0},moveBlanksDesc:function(a,b){return b>a?1:a>b?-1:0}}),this.$table.on("aftertablesort",function(b,c){var e,f,d=a(this).find("th");d.find(".arrow").remove(),e=a.fn.stupidtable.dir,f=c.direction===e.ASC?"&uarr;":"&darr;",d.eq(c.column).append('<span class="arrow">'+f+"</span>")}),this.$thead.find("input[type='checkbox']").change(function(){var b=a(this).is(":checked");d.$tbody.find("input[type='checkbox']").each(function(){a(this).prop("checked",b)})}),this.setOptions(c)},setOptions:function(b){if(this.options=a.extend({},this.options||a.fn.tableList.defaults,b),this.options.paging){var c=this;this.page_options={size:"small",alignment:"center",currentPage:1,totalPages:1,itemContainerClass:function(a,b,c){return b===c?"active":"pointer-cursor"},onPageClicked:function(a,b,d,e){c.$thead.find("th span.arrow").remove(),c.page_options.currentPage=e>=c.page_options.totalPages?c.page_options.totalPages:e,c.page_param="&page.startIndex="+(c.page_options.currentPage-1)*c.options.pageSize,c.page_param+="&page.pageSize="+c.options.pageSize,c.initTableList()},tooltipTitles:function(a,b,c){switch(a){case"first":return page_message_options.first;case"prev":return page_message_options.prev;case"next":return page_message_options.next;case"last":return page_message_options.last;case"page":return b===c?page_message_options.current_page+b:page_message_options.goto_page+b+page_message_options.page}}},this.page_param="&page.startIndex="+(this.page_options.currentPage-1)*this.options.pageSize,this.page_param+="&page.pageSize="+this.options.pageSize}this.initTableList()},initTableList:function(){var b,c;Boolean(this.options.url)&&(b=this,this.$thead.find("input[type='checkbox']").prop("checked",!1),this.$tbody.empty(),this.$tfoot.find("td").html("&nbsp;"),this.dataList=null,c=this.options.param,this.options.paging&&(c+=this.page_param),a.post(this.options.url,c,function(c){if(b.options.paging){var d=c[b.options.dataKey];if(b.dataList=d.records,0==b.dataList.length&&b.page_options.currentPage>1)return b.page_options.currentPage--,b.page_param="&page.startIndex="+(b.page_options.currentPage-1)*b.options.pageSize,b.page_param+="&page.pageSize="+b.options.pageSize,b.initTableList(),void 0;b.page_options.totalPages=0==d.totalCount%b.options.pageSize?Math.floor(d.totalCount/b.options.pageSize):Math.floor(d.totalCount/b.options.pageSize)+1,b.page_options.totalPages>1?b.$tfoot.find("td").bootstrapPaginator(b.page_options):b.$tfoot.find("td").html("&nbsp;")}else b.dataList=c[b.options.dataKey];b.$tbody.empty(),a.each(b.dataList,function(a){"function"==typeof b.options.template&&(b.options.paging?b.$tbody.append(b.options.template(a,this,(b.page_options.currentPage-1)*b.options.pageSize+a+1)):b.$tbody.append(b.options.template(a,this)))}),a(".alt").tooltip({placement:"bottom"}),b.$tbody.find("input[type='checkbox']").change(function(){b.$tbody.find("input[type='checkbox']").length==b.$tbody.find("input[type='checkbox']:checked").length?b.$thead.find("input[type='checkbox']").prop("checked",!0):b.$thead.find("input[type='checkbox']").prop("checked",!1)}),"function"==typeof b.options.finishCallBack&&b.options.finishCallBack(b.dataList)}))},refresh:function(){this.initTableList()},search:function(a){this.options.paging&&(this.page_options.currentPage=1),this.setOptions(a)},initTableListByData:function(b){var c=this;this.$thead.find("input[type='checkbox']").prop("checked",!1),this.$tbody.empty(),this.dataList=b,a.each(this.dataList,function(a){"function"==typeof c.options.template&&c.$tbody.append(c.options.template(a,this))}),a(".alt").tooltip({placement:"bottom"}),this.$tbody.find("input[type='checkbox']").change(function(){c.$tbody.find("input[type='checkbox']").length==c.$tbody.find("input[type='checkbox']:checked").length?c.$thead.find("input[type='checkbox']").prop("checked",!0):c.$thead.find("input[type='checkbox']").prop("checked",!1)}),"function"==typeof c.options.finishCallBack&&c.options.finishCallBack(c.dataList)}},c=a.fn.tableList,a.fn.tableList=function(c){var d=null;return a(this).each(function(e,f){var g=a(f),h=g.data("tableList"),i="object"!=typeof c?null:c;h?h.setOptions(i):g.data("tableList",h=new b(this,i)),d=h}),d},a.fn.tableList.defaults={url:"",param:"",dataKey:"list",finishCallBack:function(){},template:function(){},paging:!1,pageSize:30}}(jQuery);